var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},ExComponent=function(t){function e(e){var n=t.call(this)||this;return n._dataOk=!1,n._viewOk=!1,n.preScaleX=1,n.preScaleY=1,void 0!==e&&n.setData(e),n}return __extends(e,t),e.prototype.fit=function(t,e){void 0===t&&(t=1280),void 0===e&&(e=720);var n=t/e,o=Game.stage.stageWidth/Game.stage.stageHeight,i=1;i=o>n?Game.stage.stageHeight/e:Game.stage.stageWidth/t,this.preScaleX=i,this.preScaleY=i},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.$onClick,this),this.init(),this._viewOk=!0,this._dataOk&&this.active()},e.prototype.$onAddToStage=function(e,n){t.prototype.$onAddToStage.call(this,e,n),this.addToStage()},e.prototype.$onClick=function(t){this.onClick(t.target.name,t)},e.prototype.onClick=function(t,e){},e.prototype.setData=function(t){this._data=t,this._dataOk=!0,this._viewOk&&this.active()},e.prototype.setPos=function(t,e){this.x=t,this.y=e},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.active=function(){},e.prototype.addToStage=function(){},e.prototype.removeFromStage=function(){},e.prototype.sleep=function(){},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.removeFromStage()},e.prototype.destory=function(){this._data=null,this.sleep(),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.$onClick,this),this.parent&&this.parent.removeChild(this)},e}(eui.Component);__reflect(ExComponent.prototype,"ExComponent",["ILifeCycle"]);var BasePanel=function(t){function e(e,n){var o=t.call(this,e)||this;return o.layer="layer",o.modal=1,o.modalAlpha=.6,o.autoDispose=0,o.effectType=0,o.effectType=Util.getPropValue(n,"effectType",1),o.layer=Util.getPropValue(n,"layer",PanelLayer.TOP_LAYER),o.autoDispose=Util.getPropValue(n,"autoDispose",0),o.modal=Util.getPropValue(n,"modal",1),o.modalAlpha=Util.getPropValue(n,"modalAlpha",.6),o}return __extends(e,t),e.prototype.$onClick=function(t){var e=t.target.name;"closeBtn"==e||"close"==e?Game.closePanel(this):this.onClick(e,t)},e}(ExComponent);__reflect(BasePanel.prototype,"BasePanel");var Game;!function(t){function e(e,n){console.log(" _       _"),console.log("| |__   | |__"),console.log("|  _ \\  |  _ \\"),console.log("| | | | | | | |"),console.log("|_| |_| |_| |_|"),console.log("我是hh, 18964689079"),console.log("专业专注小游戏,小程序"),console.log("用最好的产品回报给大家!"),t.stage=e,"dirtyRegionPolicy"in t.stage&&(t.stage.dirtyRegionPolicy="off");var o=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",o),k=new egret.EventDispatcher,t.loop=new HH.GameLoop(t.stage),t.pop=new HH.GamePanel(t.stage),t.sound=new HH.GameSound(t.stage),t.http=new HH.GameHttp(k,n),t.socket=new HH.GameSocket(k,n),t.prepare=new HH.GamePrepare(t.stage,k,n),t.load=new HH.GameLoad(n)}function n(e){void 0===e&&(e=0),t.prepare.start(e)}function o(e){e&&t.http.setToken(e)}function i(e){e&&t.socket.setToken(e)}function r(e,n,o){t.http.get(e,n,o)}function s(e,n,o){t.http.post(e,n,o)}function a(e){t.socket.sendMessage(e)}function h(e){t.pop.close(e)}function l(e,n){return t.pop.open(e,n)}function c(e){return t.pop.isShow(e)}function u(e){return t.pop.getPanelByName(e)}function p(e){return t.pop.topPanel(e)}function d(e){t.sound&&t.sound.playMusic(e)}function f(e){t.sound&&t.sound.playSound(e)}function m(e){t.sound.musicState=e}function g(){return t.sound.musicState}function v(e){t.sound.soundState=e}function y(){return t.sound.soundState}function E(e,n){return t.registerTimer(e,n,1e3,0)}function _(e,n){return t.loop.registerEnterFrame(e,n)}function C(e,n,o,i){return t.loop.registerTimer(e,n,o,i)}function S(e,n){t.loop.registerTimer(e,n,0)}function T(e){t.loop.clearTimer(e)}function P(t,e){k.dispatchEventWith(t,!1,e)}function R(t,e,n,o){void 0===o&&(o=0);for(var i="string"==typeof t?[t]:t,r=0;r<i.length;r++){var s=i[r];k.addEventListener(s,e,n,!1,o)}}function b(t,e,n){for(var o="string"==typeof t?[t]:t,i=0;i<o.length;i++){var r=o[i];k.removeEventListener(r,e,n)}}function x(t){return k.hasEventListener(t)}function L(e,n,o){t.load.loadGroup(e,n,o)}function w(){return BoneUtil.createArmatureSync(name)}function A(t,e,n){BoneUtil.createArmature(t,e,n)}function O(t){BoneUtil.release(t)}var k;t.init=e,t.start=n,t.setToken=o,t.setSocketToken=i,t.get=r,t.post=s,t.syncMsg=a,t.closePanel=h,t.openPanel=l,t.isPanelShow=c,t.getPanel=u,t.topPanel=p,t.playMusic=d,t.playSound=f,t.setMusicState=m,t.getMusicState=g,t.setSoundState=v,t.getSoundState=y,t.registerSecond=E,t.registerEnterFrame=_,t.registerTimer=C,t.delayCall=S,t.clearTimer=T,t.emit=P,t.on=R,t.off=b,t.hasEventListener=x,t.loadResList=L,t.createArmatureSync=w,t.createArmature=A,t.releaseArmature=O}(Game||(Game={}));var ObjPool=function(){function t(t,e){void 0===e&&(e=0),this.funC=t,this.list=[],e&&this.resize(e)}return t.prototype.resize=function(t){for(var e=this.list;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},t.prototype.create=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.list;return n.length?n.pop():1==t.length?new this.funC(t[0]):2==t.length?new this.funC(t[0],t[1]):3==t.length?new this.funC(t[0],t[1],t[2]):4==t.length?new this.funC(t[0],t[1],t[2],t[3]):new this.funC},t.prototype.release=function(t){return t&&(t.release&&t.release(),this.list.push(t)),t},t}();__reflect(ObjPool.prototype,"ObjPool");var HH;!function(t){var e=function(){function t(t,e,n){this.preloadResOk=!0,this.jsonOk=!0,this.defaultResOk=!1,this.dataOk=!0,this.postResOk=!0,this.skinOk=!0,this.progress=0,this.remainWidth=100,this.weightObj={default_res:10,json:0,preLoad:90,data:0,postLoad:0},this.stage=t,this.options=n,this.eventDispatcher=e}return t.prototype.start=function(t){void 0===t&&(t=0);var e=Util.getPropValue(this.options,"maxLoadingThread",2);RES.setMaxLoadingThread(e),this.progress=t,this.remainWidth=Math.ceil(100-this.progress),this.showProgress(this.progress),this.loadDefaultRes(),this.loadSkin(),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoadGroupComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onLoadGroupProgress,this),RES.addEventListener(RES.ResourceEvent.CONFIG_LOAD_ERROR,this.onLoadError,this)},t.prototype.showProgress=function(t,e){void 0===e&&(e=""),this.eventDispatcher.dispatchEventWith("PREPARE_PROGRESS",!1,{value:t,tip:e})},t.prototype.addProgress=function(t){+t&&(this.progress+=t,this.showProgress(this.progress))},t.prototype.requestServerPath=function(){this.sendEnterCmd()},t.prototype.loadDefaultRes=function(){var t=Const.RES_VER||Math.random(),e="resource/default.res.json?v="+t;console.time("load default.res..."),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.loadDefaultResComplete,this),RES.loadConfig(e,"resource/")},t.prototype.loadSkin=function(){},t.prototype.loadDefaultResComplete=function(t){this.eventDispatcher.dispatchEventWith("PREPARE_DEFAULT_RES_COMPLETE"),console.timeEnd("load default.res..."),this.defaultResOk=!0,this.addProgress(~~(this.remainWidth*this.weightObj.default_res/100)),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.loadDefaultResComplete,this);var e=t.target;e&&e.resConfig&&e.resConfig.keyMap?(this.loadJSON(),this.loadPreloadRes()):egret.warn("获取到资源配置信息")},t.prototype.loadPreloadRes=function(){console.time("load preload_res..."),RES.loadGroup("preload")},t.prototype.loadPreloadResComplete=function(){console.timeEnd("load preload_res..."),this.preloadResOk=!0},t.prototype.loadPostRes=function(t){console.time("load post_res...")},t.prototype.loadPostResComplete=function(){console.timeEnd("load post_res..."),this.postResOk=!0},t.prototype.loadPostEnterRes=function(){egret.log("start load poseEnter_res"),this.loadPostEnterComplete()},t.prototype.loadPostEnterComplete=function(){egret.log("load poseEnter_res complete")},t.prototype.sendEnterCmd=function(){egret.log("start load enter_data"),this.onDataRes(null)},t.prototype.onDataRes=function(t){egret.log("load enter_data complete"),this.addProgress(~~(this.remainWidth*this.weightObj.data/100)),this.dataOk=!0,this.checkEnterGame()},t.prototype.loadJSON=function(){+Const.JSON_VER||Math.random();console.time("load json_config..."),this.loadJSONComplete(null)},t.prototype.loadJSONComplete=function(t){console.timeEnd("load json_config..."),this.addProgress(~~(this.remainWidth*this.weightObj.json/100)),this.jsonOk=!0,this.eventDispatcher.dispatchEventWith("PREPARE_CONFIG_COMPLETE"),this.checkEnterGame()},t.prototype.loadSkinComplete=function(){console.timeEnd("load skin_res..."),this.skinOk=!0,this.checkEnterGame()},t.prototype.onLoadGroupComplete=function(t){var e=t.groupName;"preload"==e&&this.loadPreloadResComplete(),"postEnter"==e&&this.loadPostResComplete()},t.prototype.onLoadGroupProgress=function(t){var e=t.groupName;"preload"==e?this.addProgress(this.remainWidth*this.weightObj.preLoad*1/t.itemsTotal/100):"postEnter"==e&&this.addProgress(this.remainWidth*this.weightObj.postLoad*1/t.itemsTotal/100)},t.prototype.onLoadError=function(t){egret.log(t.groupName+":"+t.itemsLoaded+"/"+t.itemsTotal)},t.prototype.checkEnterGame=function(){this.preloadResOk&&this.jsonOk&&this.skinOk&&this.enterGame()},t.prototype.enterGame=function(){this.dataOk=!1,this.preloadResOk=!1,this.jsonOk=!1,this.postResOk=!1,this.showProgress(100,"马上进入游戏"),this.weightObj=null,egret.Tween.removeAllTweens(),this.eventDispatcher.dispatchEventWith("PREPARE_COMPLETE"),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoadGroupComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onLoadGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.CONFIG_LOAD_ERROR,this.onLoadError,this)},t}();t.GamePrepare=e,__reflect(e.prototype,"HH.GamePrepare")}(HH||(HH={}));var GameEvent=function(){function t(){}return t.PREPARE_PROGRESS="PREPARE_PROGRESS",t.PREPARE_COMPLETE="PREPARE_COMPLETE",t}();__reflect(GameEvent.prototype,"GameEvent");var Combobox=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=ComboboxItem},e.prototype.$onAddToStage=function(e,n){t.prototype.$onAddToStage.call(this,e,n),this.list.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE,this.onSelect,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},e.prototype.onSelect=function(t){"selectedIndex"==t.property&&this.back&&this.list.selectedItem&&(this.back.call(this.context,this.list.selectedItem),this.parent.removeChild(this))},e.prototype.onTouchEnd=function(t){var e=t.stageX,n=t.stageY,o=this.globalPoint;o||(this.globalPoint=new egret.Point,o=this.globalPoint),this.localToGlobal(0,0,this.globalPoint);var i=o.x,r=o.y+20,s=o.x+this.width,a=o.y+this.height,h=e>=i&&s>=e&&n>=r&&a>=n;h||this.parent.removeChild(this)},Object.defineProperty(e.prototype,"data",{set:function(t){this.list.dataProvider=new eui.ArrayCollection(t)},enumerable:!0,configurable:!0}),e.prototype.setPos=function(t,e){this.x=t,this.y=e},e.prototype.setParent=function(t){this.parent!=t&&(this.parent&&this.parent.removeChild(this),t&&t.addChild(this))},e.prototype.setBack=function(t,e){this.back=t,this.context=e},e.prototype.dispose=function(){},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},e}(eui.Component);__reflect(Combobox.prototype,"Combobox");var ComboboxItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.iconImg&&(this.iconImg.source=t.icon),this.contentLbl.text=t.name||t.label},e}(eui.ItemRenderer);__reflect(ComboboxItem.prototype,"ComboboxItem");var ExBone=function(t){function e(e){var n=t.call(this)||this;return n.minWidth=10,n.minHeight=10,n.aniName="",n.loopAniName="",n.auto=!0,n.boneName=e,n}return __extends(e,t),e.prototype.childrenCreated=function(){this.initLoopAniName=this.loopAniName,this.initAniName=this.aniName||this.loopAniName,this.auto&&this.conditionPlay()},e.prototype.$onAddToStage=function(e,n){t.prototype.$onAddToStage.call(this,e,n)},e.prototype.play=function(t,e){if(void 0===e&&(e=1),t&&(0>=e&&(e=0,this.loopAniName=t),this.aniName!=t&&(this.aniName=t),this.armature)){this.armature.removeEventListener(dragonBones.AnimationEvent.FRAME_EVENT,this.onFrameEvent,this),this.armature.removeEventListener(dragonBones.AnimationEvent.COMPLETE,this.onFrameComplete,this),this.armature.addEventListener(dragonBones.AnimationEvent.FRAME_EVENT,this.onFrameEvent,this),this.armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.onFrameComplete,this);var n=this.armature.animation.animationNames;n.indexOf(t)>=0&&this.armature.animation.play(t,e)}},e.prototype.onFrameEvent=function(t){var e=t.frameLabel;this.dispatchEventWith("frame_event",!0,e)},e.prototype.onFrameComplete=function(t){this.dispatchEventWith("frame_complete",!0,t.target.name),this.aniName=null,this.conditionPlay()},Object.defineProperty(e.prototype,"source",{set:function(t){this.boneName=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boneName",{get:function(){return this._boneName},set:function(t){t!=this._boneName&&(this._boneName=t,BoneUtil.release(this.armature),this.armature=null,t&&(this.aniName=this.initAniName,this.loopAniName=this.initLoopAniName,BoneUtil.createArmature(t,this.addBone,this)))},enumerable:!0,configurable:!0}),e.prototype.addBone=function(t){t.name==this._boneName&&(this.armature=t,this.addChildAt(t.display,0),this.auto&&this.conditionPlay())},e.prototype.conditionPlay=function(){this.aniName&&this.aniName!=this.loopAniName?this.play(this.aniName):this.loopAniName&&this.play(this.loopAniName,0)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this)},e.prototype.replaceTexture=function(t){this.armature.replaceTexture(RES.getRes(t))},e.prototype.dispose=function(){this.armature&&(this.armature.removeEventListener(dragonBones.AnimationEvent.FRAME_EVENT,this.onFrameEvent,this),this.armature.removeEventListener(dragonBones.AnimationEvent.COMPLETE,this.onFrameComplete,this),this._boneName=null,BoneUtil.release(this.armature),this.armature=null),DisplayUtil.removeFromParent(this)},e}(eui.Component);__reflect(ExBone.prototype,"ExBone");var GamePanel=function(t){function e(){var e=t.call(this)||this;return e.curSide=0,e.effectType=0,e.skinName=AnimalPanelSkin,e.chessArr=[],e}return __extends(e,t),e.prototype.init=function(){this.logic=new ChessLogic,this.logic.addEventListener("move_chess",this.onMoveChess,this),this.logic.addEventListener("kill_chess",this.onKillChess,this),this.logic.addEventListener("flop_chess",this.onFlopChess,this),this.logic.addEventListener("turn_side",this.onTurnSide,this),this.logic.addEventListener("generate_chessboard",this.onGenerateChessBoard,this),this.logic.start()},e.prototype.addToStage=function(){this.chessGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onGenerateChessBoard=function(t){console.log("事件-生成棋盘");var e=t.data;GameData.chess.setChessBoard(e),this.createCheckerboard()},e.prototype.onTurnSide=function(t){var e=t.data;console.log("事件-轮到某方",e),GameData.chess.turnSide(e);var n=DisplayUtil.getChildByName(this.blueGroup,"arrowImg"),o=DisplayUtil.getChildByName(this.redGroup,"arrowImg");e==ChessSideEnum.self?(n.visible=!0,o.visible=!1):(n.visible=!1,o.visible=!0)},e.prototype.onMoveChess=function(t){console.log("事件-移动");var e=t.data,n=e[0],o=e[1],i=ChessUtil.posToIndex(n.x,n.y),r=ChessUtil.posToIndex(o.x,o.y);GameData.chess.moveChess(i,r),this.moveChess(i,r)},e.prototype.onKillChess=function(t){console.log("事件-吃棋子");var e=t.data,n=e[0],o=e[1],i=ChessUtil.posToIndex(n.x,n.y),r=ChessUtil.posToIndex(o.x,o.y);this.moveChess(i,r);var s=this.chessArr[r];s.destory(),GameData.chess.killChess(i)},e.prototype.moveChess=function(t,e){var n=this.chessArr[t],o=ChessUtil.indexToPos(e),i=ChessUtil.getPoint(o.x,o.y);if(n){var r=egret.Tween.get(n);console.log("move:",n.x,n.y,i.x,i.y),r.to({x:i.x,y:i.y},200)}else console.error("移动出错~~~")},e.prototype.onFlopChess=function(t){var e=t.data,n=e.index;console.log("事件-翻牌"),GameData.chess.openValue(e);var o=this.chessArr[n];o.flop(e)},e.prototype.active=function(){var t=GameData.chess.getSide();this.turnSide(t)},e.prototype.turnSide=function(t){this.curSide!=t&&(this.curSide=t,t==ChessSideEnum.self)},e.prototype.onTouchTap=function(t){if(GameData.chess.getSide()==ChessSideEnum.self){var e=t.target,n=e.index,o=GameData.chess.getChess(n);o?o.open?this.showTip():this.logic.dispatchEventWith("request_flop",!1,n):console.error("系统出错")}else Notice.show("当前没轮到自己")},e.prototype.showTip=function(){console.log("显示提示")},e.prototype.createCheckerboard=function(){this.chessArr.length=0;for(var t=GameData.chess.getChessBoard(),e=0,n=t.length;n>e;e++){var o=new ChessItem;o.index=e;var i=GameData.chess.getChess(e);o.reset(i),this.chessArr.push(o),this.chessGroup.addChild(o)}},e.prototype.onFlopComplete=function(){console.log("翻开完成")},e.prototype.destory=function(){},e}(BasePanel);__reflect(GamePanel.prototype,"GamePanel");var EXItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.addToStage=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.removeFromStage=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.onClick=function(t){},e.prototype.$onAddToStage=function(e,n){t.prototype.$onAddToStage.call(this,e,n),this.addToStage()},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.removeFromStage()},e}(eui.ItemRenderer);__reflect(EXItemRenderer.prototype,"EXItemRenderer");var FImage=function(t){function e(){var e=t.call(this)||this;return e.$eventPool=null,e.$isPlaying=!1,e.$currentFrameNum=0,e.$nextFrameNum=1,e.$prefix="",e.$startIndex=0,e.$frameIntervalTime=0,e.$playTimes=-1,e.$passedTime=0,e.frameRate=-1,e.totalFrame=1,e.autoPlay=!0,e.lastTime=0,e.$eventPool=[],e}return __extends(e,t),e.prototype.$onAddToStage=function(e,n){if(t.prototype.$onAddToStage.call(this,e,n),this.source){var o=this.source,i=o.search(/\d+_png/);this.$prefix=o.slice(0,i),this.$startIndex=+o.slice(i,i+1)}this.frameRate&&this.setFrameRate(this.frameRate),this.totalFrame||(this.totalFrame=1),this.autoPlay&&!this.$isPlaying&&this.totalFrame>1&&this.play()},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},e.prototype.play=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=""),this.$isPlaying=!0,e&&(this.$prefix=e),this.setPlayTimes(t),this.totalFrame>1&&this.stage&&this.setIsStopped(!1)},e.prototype.stop=function(t){this.$isPlaying=!1,this.setIsStopped(!0),t&&(this.$nextFrameNum=t,this.changeRes())},e.prototype.advanceTime=function(t){void 0===t&&(t=0);var e=this;e.$passedTime+=t;var n=e.$frameIntervalTime;e.$passedTime>=n&&(e.$passedTime%=n,e.$nextFrameNum++,e.$nextFrameNum>e.totalFrame&&(-1==e.$playTimes?(e.$eventPool.push(egret.Event.LOOP_COMPLETE),e.$nextFrameNum=1):(e.$playTimes--,e.$playTimes>0?(e.$eventPool.push(egret.Event.LOOP_COMPLETE),e.$nextFrameNum=1):(e.$nextFrameNum=e.totalFrame,e.$eventPool.push(egret.Event.COMPLETE),e.stop())))),e.handlePendingEvent(),this.changeRes()},e.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var t=this.$eventPool,e=t.length,n=!1,o=!1,i=0;e>i;i++){var r=t.pop();r==egret.Event.LOOP_COMPLETE?o=!0:r==egret.Event.COMPLETE?n=!0:this.dispatchEventWith(r)}o&&this.dispatchEventWith(egret.Event.LOOP_COMPLETE),n&&this.dispatchEventWith(egret.Event.COMPLETE)}},e.prototype.setFrameRate=function(t){this.frameRate=t,this.$frameIntervalTime=1e3/this.frameRate},Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),e.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.$playTimes=0>t?-1:Math.floor(t))},e.prototype.changeRes=function(){var t=this.$nextFrameNum-1+this.$startIndex;this.source=this.$prefix+t+"_png"},e.prototype.setIsStopped=function(t){this.$isStopped!=t&&(this.$isStopped=t,t?this.$timerId&&(Game.clearTimer(this.$timerId),this.$timerId=0):(this.$playTimes=0==this.$playTimes?1:this.$playTimes,this.$timerId=Game.registerEnterFrame(this.advanceTime,this),this.lastTime=egret.getTimer()))},e}(eui.Image);__reflect(FImage.prototype,"FImage");var Notice=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoticeSkin",e}return __extends(e,t),e.show=function(t){var n=new e;n.setData(t),Game.stage.addChild(n)},e.prototype.active=function(){var t=this.data;this.desLbl?("string"==typeof t?this.desLbl.text=t:this.desLbl.textFlow=t,this.x=(Game.stage.stageWidth-this.width)/2,this.y=Game.stage.stageHeight/3,this.alpha=0,egret.Tween.get(this).to({alpha:1,y:this.y-60},300).call(function(){egret.Tween.get(this).wait(1e3).to({alpha:0,y:this.y-60},300).call(function(){DisplayUtil.removeFromParent(this)},this)},this)):(window.alert(t),DisplayUtil.removeFromParent(this))},e}(ExComponent);__reflect(Notice.prototype,"Notice");var RedPoint=function(t){function e(){var e=t.call(this)||this;return e.jump=!0,e.timeId=0,e.touchEnabled=!1,e.touchChildren=!1,e.skinName="RedPointSkin",e.setJump(!0),e}return __extends(e,t),e.prototype.active=function(){var t=this.data;this.countLbl.text=String(t)||"",this.setJump(!0)},e.prototype.setJump=function(t){this.jump=t,this.startEffect()},e.prototype.startEffect=function(){this.jump?(egret.Tween.get(this.countLbl).to({y:-20},200,egret.Ease.sineIn).to({y:0},500,egret.Ease.bounceOut),egret.Tween.get(this.bgImg).to({y:-20},200,egret.Ease.sineIn).to({y:0},500,egret.Ease.bounceOut),this.timeId&&(Game.clearTimer(this.timeId),this.timeId=0),this.timeId||(this.timeId=Game.registerTimer(this.startEffect,this,4e3+2e3*Math.random(),0))):(this.timeId&&(Game.clearTimer(this.timeId),this.timeId=0),this.bgImg.x=0,this.bgImg.y=0,this.countLbl.y=0,egret.Tween.removeTweens(this.countLbl),egret.Tween.removeTweens(this.bgImg))},e.prototype.release=function(){this.setJump(!1),DisplayUtil.removeFromParent(this)},e.pool=new ObjPool(e),e}(ExComponent);__reflect(RedPoint.prototype,"RedPoint");var ChessData=function(){function t(){this.selfLastTime=0,this.otherLastTime=0,this.side=0;var t=ExternalUtil.getItem("chess_token");if(t)t=JSON.parse(t),this._data=t;else{for(var e=[],n=[ChessEnum.elephant,ChessEnum.tiger,ChessEnum.tiger,ChessEnum.wolf,ChessEnum.wolf,ChessEnum.wolf,ChessEnum.dog,ChessEnum.dog,ChessEnum.cat,ChessEnum.cat,ChessEnum.rat,ChessEnum.rat,ChessEnum.rat,ChessEnum.rat,ChessEnum.bomb,ChessEnum.bomb],o=0;16>o;o++){var i={};i.value=n[o],i.open=0,i.side=ChessSideEnum.self,e.push(i),i={},i.value=n[o],i.open=0,i.side=ChessSideEnum.machine,e.push(i)}ArrayUtil.shuffle(e);var r=ArrayUtil.removeRandomItem([ChessSideEnum.self,ChessSideEnum.machine]);this._data={side:r,selfHP:13,otherHP:13,lastTime:0,chessboard:e}}}return t.prototype.setChessBoard=function(t){this.chessboard=t},t.prototype.moveChess=function(t,e){var n=this.chessboard[t],o=this.chessboard[e];this.chessboard[e]=n,n&&(n.index=e),this.chessboard[t]=o,o&&(o.index=t)},t.prototype.killChess=function(t){this.chessboard[t]&&(this.chessboard[t]=null)},t.prototype.turnSide=function(t){this.side=t},t.prototype.getChessValue=function(t){var e=this._data.chessboard,n=e[t]?e[t].open?e[t].value:0:-1;return Number(n)},t.prototype.openValue=function(t){var e=this._data.chessboard,n=t.index,o=e[n];o&&(o.open=1,o.value=t.value,o.side=t.side)},t.prototype.setChessValue=function(t,e){var n=this._data.chessboard,o=n[t];o&&(o.value=e)},t.prototype.getChessRealValue=function(t){var e=this._data.chessboard;return e[t].value},t.prototype.clearCache=function(){ExternalUtil.setItem("chess_token","")},t.prototype.getChess=function(t){return this.chessboard[t]},t.prototype.getChessBoard=function(){return this.chessboard},t.prototype.getSide=function(){return this.side},t}();__reflect(ChessData.prototype,"ChessData");var GameData=function(){function t(){}return t.boot=function(){t.chess=new ChessData},t}();__reflect(GameData.prototype,"GameData");var ChessAI=function(){function t(t){this.logic=t,this.chessboard=t.chessboard}return t.prototype.calc=function(){var t=this.getAllAction(this.chessboard),e=t.shift();return console.log("翻牌行为:",e),e},t.prototype.getAllAction=function(t){for(var e=[],n=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}],o=0,i=t.length;i>o;o++){var r=o%4,s=~~(o/4),a=t[o];if(a)if(a.open){if(a.side==ChessSideEnum.machine)for(var h=a.value==ChessEnum.bomb?100:1,l=0;l<n.length;l++)for(var c=0,u=1;h>=u;u++){var p=r+n[l].x*u,d=s+n[l].y*u;if(!this.logic.inAreaByXY(p,d))break;var f=this.logic.getChessByXY(p,d);if(!f){e.push({type:"move",data:{start:{x:r,y:s},target:{x:p,y:d}}});break}a.value==ChessEnum.bomb&&c++,f.open&&a.side!=f.side&&ChessUtil.canEat(a.value,f.value)&&(a.value==ChessEnum.bomb?2==c&&e.push({type:"kill",data:{start:{x:r,y:s},target:{x:p,y:d}}}):e.push({type:"kill",data:{start:{x:r,y:s},target:{x:p,y:d}}}))}}else e.push({type:"flop",data:{index:ChessUtil.posToIndex(r,s),side:a.side,value:a.value}})}return e},t}();__reflect(ChessAI.prototype,"ChessAI");var ChessLogic=function(t){function e(){var e=t.call(this)||this;e.row=8,e.col=4,e.selfHP=13,e.otherHP=13,e.curSide=0,e.otherSide=0;var n=e.row*e.col;return e.chessboard=Array(n),e.selfRemainChessArr=[],e.otherRemainChessArr=[],e.ai=new ChessAI(e),e}return __extends(e,t),e.prototype.start=function(t){void 0===t&&(t=!1),this.addEventListener("request_flop",this.onRequestFlop,this),this.chessboard.length=0,this.selfRemainChessArr.length=0,this.otherRemainChessArr.length=0,this.selfHP=13,this.otherHP=13;var e=this.chessboard,n=[ChessEnum.elephant,ChessEnum.tiger,ChessEnum.tiger,ChessEnum.wolf,ChessEnum.wolf,ChessEnum.wolf,ChessEnum.dog,ChessEnum.dog,ChessEnum.cat,ChessEnum.cat,ChessEnum.rat,ChessEnum.rat,ChessEnum.rat,ChessEnum.rat,ChessEnum.bomb,ChessEnum.bomb];this.otherSide=t?ChessSideEnum.other:ChessSideEnum.machine;for(var o=0,i=n.length;i>o;o++){var r={};r.value=n[o],this.selfRemainChessArr.push(r.value),r.open=0,r.side=ChessSideEnum.self,e.push(r),r={},r.value=n[o],this.otherRemainChessArr.push(r.value),r.open=0,r.side=this.otherSide,e.push(r)}ArrayUtil.shuffle(e);for(var s=this.otherSide,a=[],o=0,i=e.length;i>o;o++)e[o].index=o,a.push({index:o,open:0});this.dispatchEventWith("generate_chessboard",!1,a),this.turn(s)},e.prototype.turn=function(t){if(this.curSide=t,this.dispatchEventWith("turn_side",!1,t),t==ChessSideEnum.machine){var e=1e3;egret.setTimeout(this.calc,this,e)}},e.prototype.calc=function(){var t=this.ai.calc();"move"==t.type?this.move(t.data.start,t.data.target):"kill"==t.type?this.move(t.data.start,t.data.target):"flop"==t.type?this.flop(t.data.index):"surrender"==t.type},e.prototype.move=function(t,e){var n=t.x,o=t.y,i=e.x,r=e.y,s=ChessUtil.posToIndex(n,o),a=ChessUtil.posToIndex(i,r),h=this.chessboard[s],l=this.chessboard[a];h?l?h.side==l.side?console.error("不能吃同类"):ChessUtil.canEat(h.value,l.value)?(this.chessboard[a]=h,this.chessboard[s]=null,l.side==ChessSideEnum.self?ArrayUtil.removeItem(this.selfRemainChessArr,l.value):ArrayUtil.removeItem(this.otherRemainChessArr,l.value),this.dispatchEventWith("kill_chess",!1,[Util.mixin(t,{}),Util.mixin(e,{})]),this.turn(this.curSide==ChessSideEnum.self?this.otherSide:ChessSideEnum.self)):console.error("不能吃"):Math.abs(i-n)+Math.abs(r-o)!=1?console.error("不能移动"):(this.chessboard[a]=h,this.chessboard[s]=null,this.dispatchEventWith("move_chess",!1,[Util.mixin(t,{}),Util.mixin(e,{})]),this.turn(this.curSide==ChessSideEnum.self?this.otherSide:ChessSideEnum.self)):console.error("系统错误")},e.prototype.flop=function(t){var e=this.chessboard[t];!e||e.open?console.error("翻牌出错了 ["+t+"]"):(e.open=1,this.dispatchEventWith("flop_chess",!1,Util.mixin(e,{})),this.turn(this.curSide==ChessSideEnum.self?this.otherSide:ChessSideEnum.self))},e.prototype.onRequestFlop=function(t){var e=t.data;this.flop(e)},e.prototype.surrender=function(){},e.prototype.getClosedCount=function(){for(var t=0,e=0,n=this.chessboard.length;n>e;e++){var o=this.getChess(e);o&&!o.open&&t++}return t},e.prototype.inAreaByXY=function(t,e){return t>=0&&4>t&&e>=0&&8>e},e.prototype.inArea=function(t){return t>=0&&32>t},e.prototype.getChess=function(t){return this.chessboard[t]},e.prototype.getChessByXY=function(t,e){var n=e*this.col+t;return this.getChess(n)},e.prototype.isEmpty=function(t){return null==this.chessboard[t]},e}(egret.EventDispatcher);__reflect(ChessLogic.prototype,"ChessLogic");var ChessUtil=function(){function t(){}return t.indexToPos=function(t){var e={x:0,y:0};return e.x=t%4,e.y=~~(t/4),e},t.posToIndex=function(t,e){var n=4*e+t;return n},t.getPoint=function(t,e){var n={x:108*t,y:104*e};return n},t.canEat=function(t,e){return t==ChessEnum.bomb?!0:t==ChessEnum.elephant?e==ChessEnum.rat?!1:!0:t==ChessEnum.rat?e==ChessEnum.rat||e==ChessEnum.elephant?!0:!1:t>=e},t}();__reflect(ChessUtil.prototype,"ChessUtil");var Player=function(){function t(){this.life=13}return t.prototype.move=function(t,e){},t}();__reflect(Player.prototype,"Player");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function o(o){e.call(n,o,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?o(i):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.stage?e.addToStage():e.once(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e}return __extends(e,t),e.prototype.addToStage=function(){Game.init(this.stage,{}),GameData.boot(),Game.on(GameEvent.PREPARE_COMPLETE,this.startGame,this),Game.start()},e.prototype.startGame=function(){Game.openPanel(GamePanel)},e}(egret.DisplayObject);__reflect(Main.prototype,"Main");var HH;!function(t){var e=function(){function t(t,e){this.MEAN_WHILE=2,this.host="",this.requestCount=0,this.log=0,this.eventDispatcher=t,this.host=Util.getPropValue(e,"http"),this.log=Util.getPropValue(e,"log"),this.requestCount=0,this.reqList=[],this.stateMap={},this.errorArr=[],this.freeLoaderList=[],this.freeReqList=[]}return t.prototype.setToken=function(t){t&&(this.token=t)},t.prototype.send=function(t,e,n,o){void 0===o&&(o="get");var i=null;i=this.freeReqList.length?this.freeReqList.pop():{},i.cmd=t,i.body=e,i.method=o,i.cbObj=n||{},this.reqList.push(i),this.next()},t.prototype.get=function(t,e,n){this.send(t,e,n,"get")},t.prototype.post=function(t,e,n){this.send(t,e,n,"post")},t.prototype.next=function(){if(this.reqList.length>0&&this.requestCount<this.MEAN_WHILE){this.requestCount++;var t=this.reqList.shift(),e=this.getRequest(t),n=this.getLoader();n.__reqInfo=t,n.addEventListener(egret.Event.COMPLETE,this.onComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),n.load(e)}},t.prototype.getRequest=function(t){var e,n=t.body,o=t.method,i=t.cmd,r=this.host,s="post"!=String(o).toLowerCase(),a="";for(var h in n)a+="&"+h+"="+n[h];return this.token&&(a+="&token="+this.token),a=a.substr(1),s?(r+=i+"?",e=new egret.URLRequest(r+a),e.method=egret.URLRequestMethod.GET):(r+=i,e=new egret.URLRequest(r),e.method=egret.URLRequestMethod.POST,e.data=new egret.URLVariables(a)),this.log&&console.log(">>>  "+(s?"get":"post")+" "+(r+(s?"":"?")+a)),e},t.prototype.getLoader=function(){var t=this.freeLoaderList.pop();return t||(t=new egret.URLLoader,t.dataFormat=egret.URLLoaderDataFormat.TEXT),t},t.prototype.onComplete=function(t){var e=t.target;this.doResponse(e)},t.prototype.onError=function(t){var e=t.target;
this.doError(e)},t.prototype.doError=function(t){var e=t.__reqInfo,n=!1,o=e.body,i=e.cmd,r=JSON.parse(t.data);if(this.log&&console.log(">>>  res} "+i,r),r){var s=+r.code;if(s)if(void 0===this.stateMap[i]?this.stateMap[i]=1:(this.stateMap[i]=this.stateMap[i]+1,this.stateMap[i]>3&&this.errorArr.push(i),this.eventDispatcher.dispatchEventWith("HTTP_MESSAGE_ERROR",!1,i)),this.stateMap[i]>=3)n=!0;else{var a=this.getRequest(e);t.load(a)}else n=!0;if(n){if("function"==typeof e.cbObj)e.cbObj(r,o);else{var h=e.cbObj,l=h.cb,c=h.scope;l&&l.call(c,r,o)}this.eventDispatcher.dispatchEventWith("HTTP_MESSAGE",!1,{req:o,res:r}),this.stateMap[i]=0,t.__reqInfo=null,t.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),e.body=null,e.method=null,e.cbObj=null,e.cmd=null,this.freeReqList.push(e),this.freeLoaderList.push(t),ArrayUtil.removeItem(this.errorArr,i),this.requestCount-=1,this.next()}}else this.eventDispatcher.dispatchEventWith("HTTP_MESSAGE_ERROR",!1,i)},t.prototype.doResponse=function(t){var e=t.__reqInfo,n=(e.body,e.cmd),o=JSON.parse(t.data);if(this.log&&console.log(n,o),o){if("function"==typeof e.cbObj)e.cbObj(o,e);else{var i=e.cbObj,r=i.cb,s=i.scope;r&&r.call(s,o,e)}this.eventDispatcher.dispatchEventWith("HTTP_MESSAGE",!1,{req:e,res:o}),this.stateMap[n]=0,t.__reqInfo=null,t.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),e.body=null,e.method=null,e.cbObj=null,e.cmd=null,this.freeReqList.push(e),this.freeLoaderList.push(t),ArrayUtil.removeItem(this.errorArr,n),this.requestCount-=1,this.next()}},t}();t.GameHttp=e,__reflect(e.prototype,"HH.GameHttp")}(HH||(HH={}));var HH;!function(t){var e=function(){function t(t){this.uid=0,this.waitList=[],RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.groupLoadComplete,this)}return t.prototype.groupLoadComplete=function(t){var e=t.groupName;this.doLoadComplete(e)},t.prototype.doLoadComplete=function(t,e){for(var n=this.waitList.length,o=0;n>o;o+=3)if(this.waitList[o]==t){var i=this.waitList[o+1],r=this.waitList[o+2];i.call(r,e,t),this.waitList.splice(o,3);break}},t.prototype.loadGroup=function(t,e,n,o,i){if(this.uid++,o||(o="group_#_"+this.uid),"preload"==o){for(var r=0,s=t.length;s>r;r++)t[r].url+="?+"+Math.random();this.waitList.push(o,e,n),RES.loadGroup("preload")}else this.waitList.push(o,e,n),RES.createGroup(o,t),RES.loadGroup(o,i)},t.prototype.loadConfigGroup=function(t,e,n,o){for(var i=t?t.length:0,r=[],s=0;i>s;s++)r.push(t[s].url);this.loadGroup(r,e,n,o)},t.prototype.loadDragonBone=function(t,e,n,o){var i=[];i.push(t+"_ske_json"),i.push(t+"_tex_json"),i.push(t+"_tex_png"),this.loadGroup(i,e,n,t,o)},t.prototype.loadMC=function(t,e,n,o){var i=[];i.push(t+"_json"),i.push(t+"_png"),this.loadGroup(i,e,n,t,o)},t.prototype.loadList=function(t,e,n,o){function i(){var a=t.shift();RES.getResByUrl(a,function(h){r[a]=h,n&&n.call(o,(s-t.length)/s),t.length<=0?e.call(o,r):i()},this)}var r={},s=t.length;i()},t}();t.GameLoad=e,__reflect(e.prototype,"HH.GameLoad")}(HH||(HH={}));var HH;!function(t){var e=function(){function t(t){this.id=1,this.pool=[],this.timerArr=[],this.timerMap={},this.oldTimer=egret.getTimer(),t.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)}return t.prototype.onEnterFrame=function(){for(var t=egret.getTimer(),e=t-this.oldTimer,n=this.timerArr.length,o=0;n>o;o++){var i=this.timerArr[o];i&&(i.back?i.delay<=0?(i.back.call(i.context,e),1==i.repeat&&this.clearTimer(i.id)):(i.time+=e,i.time>i.delay&&(i.time-=i.delay,i.back.call(i.context,e,i.repeat),i.repeat>=1&&(1==i.repeat?this.clearTimer(i.id):i.repeat--))):(this.release(i),this.timerArr[o]=null))}this.oldTimer=t},t.prototype.registerEnterFrame=function(t,e){return this.registerTimer(t,e,0,0)},t.prototype.clearTimer=function(t){var e=this.timerMap[t];e&&(e.back=null)},t.prototype.release=function(t){t&&t.id>0&&(this.timerMap[t.id]=null,t.back=null,t.context=null,t.id=-1,t.repeat=0,t.delay=0,this.pool.push(t))},t.prototype.registerTimer=function(t,e,n,o){if(void 0===n&&(n=1e3),void 0===o&&(o=1),t){var i=this.pool.pop();i||(i={}),i.repeat=o,i.delay=n,i.time=0,i.back=t,i.context=e;var r=this.id++;i.id=r;var s=isNaN(i.index)?this.timerArr.length:i.index;return i.index=s,this.timerArr[s]=i,this.timerMap[r]=i,r}return console.error("registerTimer error"),0},t}();t.GameLoop=e,__reflect(e.prototype,"HH.GameLoop")}(HH||(HH={}));var HH;!function(t){var e=function(){function t(t){this._layerMap=null,this._panelMap=null,this.stage=t,this._layerMap={},this._panelMap={};for(var e=[PanelLayer.BOTTOM_LAYER,PanelLayer.TOP_LAYER,PanelLayer.ALERT_LAYER],n=0,o=e.length;o>n;n++){var i=e[n],r=new eui.Group;r.name=i,r.width=t.stageWidth,r.height=t.stageHeight,r.touchEnabled=!1,r.touchChildren=!0,t.addChild(r),this._layerMap[i]=r}}return t.prototype.getLayer=function(t){return this._layerMap[t]},t.prototype.closeLayer=function(t){for(var e=this.getLayer(t);e.numChildren;){var n=e.getChildAt(e.numElements-1);n instanceof eui.Image?DisplayUtil.removeFromParent(n):this.hidePanel(n)}},t.prototype.getPanelByName=function(t){return t=this.getPanelName(t),this._panelMap[t]},t.prototype.topPanel=function(t){if(t){var e=this._layerMap[t.layer],n=t.name+"_modal";e.setChildIndex(t,e.numChildren-1),e.getChildByName(n)&&e.setChildIndex(t,e.numChildren-1)}},t.prototype.isShow=function(t){var e=this.getPanelName(t),n=this._panelMap[e];return n&&n.visible&&n.stage},t.prototype.getPanelList=function(t){var e=[];for(var n in this._panelMap){var o=this._panelMap[n];(o&&o.layer==t||!t)&&e.push(o)}return e},t.prototype.addModel=function(t){var e=this._layerMap[t.layer];if(t.modal){var n=DisplayUtil.createStageMask(this.stage);n.name=t.name+"_modal",e.addChild(n)}},t.prototype.showPanel=function(t,e){t=this.getPanelName(t);var n=egret.getDefinitionByName(t),o=this._panelMap[t];if(o||(o=new n,o.name=t,this._panelMap[o.name]=o),o){if(console.log("[ShowPanel] "+t),!o.parent){this.addModel(o);var i=o.layer||PanelLayer.TOP_LAYER,r=this._layerMap[i];r.addChild(o),this.addOpenEffect(o)}o.setData(e),this.stage.dispatchEventWith("panel_opened",t)}else console.warn("[ShowPanel] "+t+" error");return o},t.prototype.open=function(t,e){return this.showPanel(t,e)},t.prototype.hidePanel=function(t){t=this.getPanelName(t);var e=this._panelMap[t];if(e){if(console.log("[HidePanel] <<< ",t),egret.Tween.removeTweens(e),e.parent){var n=this._layerMap[e.layer];e.modal&&DisplayUtil.removeChildByName(n,e.name+"_modal"),e.sleep(),this.addCloseEffect(e)}var o=e.autoDispose;o&&(e.removeFromStage(),e.destory(),delete this._panelMap[t])}else console.warn("[HidePanel] "+t+" 已经关闭了");this.stage.dispatchEventWith("panel_closed",t)},t.prototype.close=function(t){this.hidePanel(t)},t.prototype.getPanelName=function(t){var e="",n=typeof t;return"string"==n?e=t:t instanceof eui.Component?e=t.name:t instanceof Function&&(e=egret.getQualifiedClassName(t)),e},t.prototype.addOpenEffect=function(t){egret.Tween.removeTweens(t);var e=this.stage.stageWidth,n=this.stage.stageHeight,o=t.width,i=t.height,r=t.preScaleX||1,s=t.preScaleY||1;switch(t.effectType){case 1:t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=e/2,t.y=n/2,t.scaleX=.5,t.scaleY=.5,t.alpha=0,egret.Tween.get(t).to({scaleX:r,scaleY:s,alpha:1},300,egret.Ease.backOut);break;case 2:t.y=-n,egret.Tween.get(t).to({y:.5*(n-i)},300,egret.Ease.backOut);break;case 3:t.y=n,egret.Tween.get(t).to({y:.5*(n-i)},300,egret.Ease.backOut);break;case 4:t.x=-e,egret.Tween.get(t).to({x:.5*(e-o)},300,egret.Ease.backOut);break;case 5:t.x=e,egret.Tween.get(t).to({x:.5*(e-o)},300,egret.Ease.backOut);break;case 6:egret.Tween.get(t).set({alpha:0}).to({alpha:1},300)}},t.prototype.addCloseEffect=function(t){egret.Tween.removeTweens(t);var e=this.stage.stageWidth,n=this.stage.stageHeight,o=null;switch(t.effectType){case 1:o=egret.Tween.get(t).to({scaleX:.5,scaleY:.5,alpha:0},300,egret.Ease.backIn);break;case 2:o=egret.Tween.get(t).to({y:-n},300,egret.Ease.backIn);break;case 3:o=egret.Tween.get(t).to({y:n},300,egret.Ease.backIn);break;case 4:o=egret.Tween.get(t).to({x:-e},300,egret.Ease.backIn);break;case 5:o=egret.Tween.get(t).to({x:e},300,egret.Ease.backIn);break;case 6:egret.Tween.get(t).set({alpha:1}).to({alpha:0},300)}o?o.call(function(){DisplayUtil.removeFromParent(t)},this):DisplayUtil.removeFromParent(t)},t}();t.GamePanel=e,__reflect(e.prototype,"HH.GamePanel")}(HH||(HH={}));var Const=function(){function t(){}return t.RES_VER="",t.JSON_VER="",t.SKIN_VER="",t}();__reflect(Const.prototype,"Const");var HH;!function(t){var e=function(){function t(t,e){this.port=0,this.log=0,this.reconnectDelay=0,this.reconnectCount=0,this.meanTimeCount=0,this.waitList=[],this.timeId=0,this.timerPingId=0,this.eventDispatcher=t,this.host=Util.getPropValue(e,"remote"),this.port=Util.getPropValue(e,"port",0),this.log=Util.getPropValue(e,"log",1),this.reconnectDelay=Util.getPropValue(e,"reconnectDelay",300),this.reconnectCount=Util.getPropValue(e,"reconnectCount",10),this.meanTimeCount=Util.getPropValue(e,"meanTimeCount",5),this.host||(this.host=e),this.socket=new egret.WebSocket,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this)}return t.prototype.onReceiveMessage=function(t){var e=t.target,n=e.readUTF(),o=JSON.parse(n);this.log&&console.log("[socket_response]<<<---",n),this.eventDispatcher.dispatchEventWith("SOCKET_MESSAGE",!1,o)},t.prototype.setToken=function(t){t&&(this.token=t)},t.prototype.onSocketOpen=function(){console.log("connect success："),this.eventDispatcher.dispatchEventWith("SOCKET_CONNECT"),this.timeId&&(Game.clearTimer(this.timeId),this.timeId=0),this.trySendMessage()},t.prototype.onSocketClose=function(t){this.eventDispatcher.dispatchEventWith("SOCKET_CLOSE"),console.log("connect fail：",t.data),this.timeId||(this.timeId=Game.registerTimer(this.onConnect,this,this.reconnectDelay,this.reconnectCount)),this.timerPingId&&(Game.clearTimer(this.timerPingId),this.timerPingId=0)},t.prototype.onConnect=function(t,e){1==e?(this.eventDispatcher.dispatchEventWith("SOCKET_INVALID"),Game.clearTimer(this.timeId),this.timeId=0):this.connect()},t.prototype.sendMessage=function(t){this.waitList.push(t),this.trySendMessage()},t.prototype.trySendMessage=function(){var t=this.socket.connected,e=this.meanTimeCount,n=this.waitList.length,o=Math.min(n,e);if(t)for(var i=0;o>i;i++){var r=this.waitList.shift(),s=JSON.stringify(r);this.log&&console.log("[socket_send]--->>>",s),this.socket.writeUTF(s)}},t.prototype.close=function(){this.socket.close()},t.prototype.connect=function(){this.port?this.socket.connect(this.host,this.port):this.socket.connectByUrl(this.host),this.log&&console.log("socket connect:",this.host,this.port)},t}();t.GameSocket=e,__reflect(e.prototype,"HH.GameSocket")}(HH||(HH={}));var HH;!function(t){var e=function(){function t(t){var e=this;this._soundState=!0,this._musicState=!0,this.activate=!0,this.stage=t.stage,this.stage.addEventListener(egret.Event.DEACTIVATE,function(){e.activate=!1,e.checkPlayMusic(),e.checkPlaySound()},this),this.stage.addEventListener(egret.Event.ACTIVATE,function(){e.activate=!0,e.checkPlayMusic(),e.checkPlaySound()},this),this.soundCompList=[],this.freeList=[],this.playingList=[],this.musicComp=null}return t.prototype.playMusic=function(t){this.play(t,0)},t.prototype.playSound=function(t){this.play(t,1)},t.prototype.play=function(t,e){var o=Boolean(e);if(o){var i=this.freeList.pop();i||(i=new n(e)),this.playingList.push(i),i.addEventListener(egret.Event.COMPLETE,this.playComplete,this),i.play(t)}else this.musicComp||(this.musicComp=new n(e)),this.musicComp.play(t)},t.prototype.playComplete=function(t){var e=t.target;e.isSound&&ArrayUtil.removeItem(this.playingList,e),e.removeEventListener(egret.Event.COMPLETE,this.playComplete,this),this.freeList.push(e)},Object.defineProperty(t.prototype,"soundState",{get:function(){return this._soundState},set:function(t){this._soundState!=t&&(this._soundState=t,this.checkPlaySound())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"musicState",{get:function(){return this._musicState},set:function(t){this._musicState!=t&&(this._musicState=t,this.checkPlayMusic())},enumerable:!0,configurable:!0}),t.prototype.checkPlaySound=function(){for(var t=this.playingList.concat(),e=0,n=t.length;n>e;e++){var o=t[e];o?o.pause=!(this._soundState&&this.activate):console.log("播放声音可能出错")}},t.prototype.checkPlayMusic=function(){var t=this.musicComp;t&&(t.pause=!(this._musicState&&this.activate))},t}();t.GameSound=e,__reflect(e.prototype,"HH.GameSound");var n=function(t){function e(e){var n=t.call(this)||this;return n._isSound=e,n._pause=!1,n}return __extends(e,t),Object.defineProperty(e.prototype,"isSound",{get:function(){return this._isSound},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pause",{set:function(t){this._pause!=t&&(this._pause=t,t?(this.lastURL=this.url,this.close()):this.play(this.lastURL))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&this.play(t)},enumerable:!0,configurable:!0}),e.prototype.play=function(t){var e=this;if(this.lastURL=null,t!=this._url){var n=t;if(this._url=t,n){var o=this._isSound,i=o?1:0;RES.hasRes(this._url)?RES.getResAsync(n,function(t){e.sound=t,e._pause||(e.channel=t.play(0,i),t.addEventListener(egret.Event.COMPLETE,e.playComplete,e))},this):RES.getResByUrl(n,function(t){e.sound=t,e._pause||(e.channel=t.play(0,i),t.addEventListener(egret.Event.COMPLETE,e.playComplete,e))},this,RES.ResourceItem.TYPE_SOUND)}}},e.prototype.playComplete=function(t){t.target.removeEventListener(egret.Event.COMPLETE,this.playComplete,this),this.close()},e.prototype.close=function(){this._url=null,this.sound&&(this.sound.removeEventListener(egret.Event.COMPLETE,this.playComplete,this),this.sound=null),this.channel&&(this.channel.stop(),this.channel=null),this._isSound&&(this.lastURL=null,this.dispatchEventWith(egret.Event.COMPLETE))},e}(egret.EventDispatcher);__reflect(n.prototype,"SoundComp")}(HH||(HH={}));var ChessItem=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.side=1,e.cardValue=0,e.canFlop=!1,e.touchChildren=!1,e.skinName=AnimalIconSkin,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.reset=function(t){this.index=t.index;var e=~~(this.index/4),n=this.index%4,o=ChessUtil.getPoint(n,e);this.x=o.x,this.y=o.y,this.side=t.side,this.canFlop=!0;var i=this.getCardValue();i&&(this.side==ChessSideEnum.self?this.typeImg.source="animal_bule_"+i+"_png":this.typeImg.source="animali_red_"+i+"_png",this.animalImg.source="animal_"+i+"_png"),this.animalImg.visible=!!i,this.backImg.visible=!Boolean(i)},e.prototype.flop=function(t){if(this.canFlop){this.canFlop=!1;var e=t.value,n=t.side;n==ChessSideEnum.self?this.typeImg.source="animal_bule_"+e+"_png":this.typeImg.source="animali_red_"+e+"_png",this.animalImg.source="animal_"+e+"_png",this.animalImg.visible=!0,ClipEff.start(this.backImg,this.frontGroup,null,this.flopComplete,this)}},e.prototype.flopComplete=function(){this.canFlop=!0,this.dispatchEventWith("flop_complete",!0)},e.prototype.show=function(){},e.prototype.getCardValue=function(){return GameData.chess.getChessValue(this.index)},e.prototype.destory=function(){DisplayUtil.removeFromParent(this)},e}(ExComponent);__reflect(ChessItem.prototype,"ChessItem");var ChessEnum=function(){function t(){}return t.elephant=7,t.tiger=6,t.wolf=5,t.dog=4,t.cat=3,t.rat=1,t.bomb=10,t}();__reflect(ChessEnum.prototype,"ChessEnum");var ChessSideEnum;!function(t){t[t.self=1]="self",t[t.other=2]="other",t[t.machine=3]="machine"}(ChessSideEnum||(ChessSideEnum={}));var PanelLayer=function(){function t(){}return t.BOTTOM_LAYER="bottom",t.TOP_LAYER="top",t.ALERT_LAYER="alert",t}();__reflect(PanelLayer.prototype,"PanelLayer");var PanelEffect=function(){function t(){}return t.NO=0,t.Center=1,t.Top=2,t.Bottom=3,t.Left=4,t.Right=5,t}();__reflect(PanelEffect.prototype,"PanelEffect");var SoundType=function(){function t(){}return t.SOUND=0,t.EFFECT=1,t}();__reflect(SoundType.prototype,"SoundType");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,o){function i(t){e.call(o,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(o))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(o,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ClipEff=function(){function t(){}return t.start=function(t,e,n,o,i){var r=Util.getPropValue("options","flipSpeed",200),s=Util.getPropValue("options","flipZoom",1.2);t.touchEnabled=!1,e.touchEnabled=!1;var a=egret.Tween.get(t);a.to({scaleX:0,scaleY:s},r/2),a.call(function(){e.visible=!0,e.scaleX=0,e.scaleY=s;var t=egret.Tween.get(e);t.to({scaleX:1,scaleY:1},r/2),o&&t.call(o,i)})},t}();__reflect(ClipEff.prototype,"ClipEff");var JumpEffect=function(){function t(t){this.startY=0,this.target=t,this.startY=this.target.y}return t.prototype.start=function(t){var e=this.target,n=this.startY,o=Util.getPropValue(t,"offY",20),i=Util.getPropValue(t,"loop",!0),r=Util.getPropValue(t,"upTime",2e3),s=Util.getPropValue(t,"downTime",2e3),a=Util.getPropValue(t,"waitTime",0),h=egret.Tween.get(e,{loop:i});h.to({y:n-o},r,egret.Ease.cubicIn).wait(a).to({y:n},s,egret.Ease.cubicOut)},t.prototype.end=function(){egret.Tween.removeTweens(this.target),this.target.y=this.startY,this.target=null},t}();__reflect(JumpEffect.prototype,"JumpEffect");var ShakeEff=function(t){function e(e,n,o){var i=t.call(this)||this;return i.startX=0,i.startY=0,i.isShaking=!1,i.intensity=1,i.duration=1e3,i.timerId=0,i.target=e,i.cb=n,i.cbObj=o,i}return __extends(e,t),e.prototype.start=function(t,e){void 0===t&&(t=1e3),void 0===e&&(e=.05),this.isShaking||(this.startX=this.target.x,this.startY=this.target.y,this.isShaking=!0,this.duration=t,this.intensity=e,this.timerId=Game.loop.registerEnterFrame(this.update,this))},e.prototype.update=function(t){var e=this.intensity;if(this.duration-=t,this.duration>0){var n=e*this.target.width*(2*Math.random()-1),o=e*this.target.height*(2*Math.random()-1);this.target.x=this.startX+n,this.target.y=this.startY+o}else this.end()},e.prototype.end=function(){this.isShaking&&(this.isShaking=!1,this.target.x=this.startX,this.target.y=this.startY,this.timerId&&(Game.loop.clearTimer(this.timerId),this.timerId=0),this.cb&&this.cb.call(this.cbObj),this.dispatchEventWith(egret.Event.COMPLETE),this.cb=null,this.cbObj=null)},e.prototype.dispose=function(){this.end(),this.target=null},e}(egret.EventDispatcher);__reflect(ShakeEff.prototype,"ShakeEff");var EventManager=function(t){function e(){var e=t.call(this)||this;return e.eventDisPatcher=new egret.EventDispatcher,e}return __extends(e,t),e.prototype.dispatch=function(t,e){this.eventDisPatcher.dispatchEventWith(t,!1,e)},e.prototype.has=function(t){return this.eventDisPatcher.hasEventListener(t)},e.prototype.once=function(t,e,n){this.eventDisPatcher.once(t,e,n)},e.prototype.on=function(t,e,n){this.eventDisPatcher.addEventListener(t,e,n)},e.prototype.off=function(t,e,n){this.eventDisPatcher.removeEventListener(t,e,n)},e}(egret.EventDispatcher);__reflect(EventManager.prototype,"EventManager");var ArrayUtil;!function(t){function e(t,e,n){if(t){void 0===e&&(e=0),void 0==n&&(n=t.length);var o=e+Math.random()*n>>0;return void 0===t[o]?null:t[o]}}function n(t,e,n){if(t){void 0===e&&(e=0),void 0==n&&(n=t.length);var o=e+Math.floor(Math.random()*n);if(o<t.length){var i=t.splice(o,1);return void 0===i[0]?null:i[0]}return null}}function o(t,e){if(t){var n=t.indexOf(e);if(n>=0)return t.splice(n,1),!0}return!1}function i(t,e){for(var n=[],o=t.length,i=0,r=0;o>r;r++)n[i]||(n[i]=[]),n[i].push(t[r]),n[i].length>=e&&i++;return n}function r(t,e){void 0===t&&(t=1),void 0===e&&(e=0);for(var n=Array(t),o=0;t>o;o++)n[o]=e;return n}function s(t,e){for(var n=[],o=t;e>=o;o++)n.push(o);return n}function a(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),o=t[e];t[e]=t[n],t[n]=o}return t}function h(t,e,n){var o=t?t.length:0;if(e>=0&&o>e&&n>=0&&o>n){var i=t[e];t[e]=t[n],t[n]=i}else console.warn("swap fail")}function l(t,e){if(e<t.length){for(var n=t.length-1,o=t[e],i=e;n>i;i++)t[i]=t[i+1];return t.length=n,o}return null}function c(t,e){if(!t.length)return 0/0;if(1===t.length||e<t[0])return t[0];for(var n=1;t[n]<e;)n++;var o=t[n-1],i=n<t.length?t[n]:Number.POSITIVE_INFINITY;return e-o>=i-e?i:o}t.getRandomItem=e,t.removeRandomItem=n,t.removeItem=o,t.oneToTwoDim=i,t.fill=r,t.numberArray=s,t.shuffle=a,t.swap=h,t.spliceOne=l,t.findClosestInSorted=c}(ArrayUtil||(ArrayUtil={}));var Base64;!function(t){function e(t){var e,n,o,r,s,a;for(o=t.length,n=0,e="";o>n;){if(r=255&t.charCodeAt(n++),n==o){e+=i.charAt(r>>2),e+=i.charAt((3&r)<<4),e+="==";break}if(s=t.charCodeAt(n++),n==o){e+=i.charAt(r>>2),e+=i.charAt((3&r)<<4|(240&s)>>4),e+=i.charAt((15&s)<<2),e+="=";break}a=t.charCodeAt(n++),e+=i.charAt(r>>2),e+=i.charAt((3&r)<<4|(240&s)>>4),e+=i.charAt((15&s)<<2|(192&a)>>6),e+=i.charAt(63&a)}return e}function n(t){var e,n,o,i,s,a,h;for(a=t.length,s=0,h="";a>s;){do e=r[255&t.charCodeAt(s++)];while(a>s&&-1==e);if(-1==e)break;do n=r[255&t.charCodeAt(s++)];while(a>s&&-1==n);if(-1==n)break;h+=String.fromCharCode(e<<2|(48&n)>>4);do{if(o=255&t.charCodeAt(s++),61==o)return h;o=r[o]}while(a>s&&-1==o);if(-1==o)break;h+=String.fromCharCode((15&n)<<4|(60&o)>>2);do{if(i=255&t.charCodeAt(s++),61==i)return h;i=r[i]}while(a>s&&-1==i);if(-1==i)break;h+=String.fromCharCode((3&o)<<6|i)}return h}function o(t){var e,n,o,i,r,s;for(e="",o=t.length,n=0;o>n;)switch(i=t.charCodeAt(n++),i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=t.charAt(n-1);break;case 12:case 13:r=t.charCodeAt(n++),e+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=t.charCodeAt(n++),s=t.charCodeAt(n++),e+=String.fromCharCode((15&i)<<12|(63&r)<<6|(63&s)<<0)}return e}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);t.base64encode=e,t.base64decode=n,t.utf8to16=o}(Base64||(Base64={}));var BoneUtil;!function(t){function e(t,e,o){var i=n(t);i?e.call(o,i):Game.load.loadDragonBone(t,function(){var i=n(t);e&&e.call(o,i)},null)}function n(t){var e=""+t;if(i[e]&&i[e].length>0){var n=i[e].pop();return dragonBones.WorldClock.clock.add(n),n}var o=RES.getRes(e+"_ske_json"),a=RES.getRes(e+"_tex_json"),h=RES.getRes(e+"_tex_png");if(o&&a&&h){if(!r[e]){r[e]=[],o.armature[0].name=t;var l=o.version,c=dragonBones.DataParser.DATA_VERSIONS;c&&c.indexOf(l)<0&&(egret.error("dragonbones verion error:"+l),o.version=c[c.length-1]);var u=s.getDragonBonesData(e);u||s.parseDragonBonesData(o),s.parseTextureAtlasData(a,h,e)}var n=s.buildArmature(e);return n.cacheFrameRate=30,dragonBones.WorldClock.clock.add(n),r[e].push(n),n}return null}function o(t){if(t){var e=t.name;i[e]||(i[e]=[]),t.display.scaleX=1,t.display.scaleY=1,t.display.x=0,t.display.y=0,DisplayUtil.removeFromParent(t.display),t.animation.stop(),dragonBones.WorldClock.clock.remove(t),i[e].push(t)}}var i={},r={},s=new dragonBones.EgretFactory;t.createArmature=e,t.createArmatureSync=n,t.release=o}(BoneUtil||(BoneUtil={}));var DisplayUtil;!function(t){function e(t,e,n){void 0===e&&(e="guide_gray_png"),void 0===n&&(n=.6);var o=new egret.Shape;return o.graphics.beginFill(0,n),o.graphics.drawRect(0,0,t.stageWidth,t.stageHeight),o.touchEnabled=!0,o.graphics.endFill(),o}function n(t){t&&t.parent&&t.parent.removeChild(t)}function o(t){t.removeChildren()}function i(t,e){return t?t.getChildByName(e):null}function r(t,e){if(t&&e){var n=t.getChildByName(e);n&&t.removeChild(n)}}t.createStageMask=e,t.removeFromParent=n,t.removeAllChildren=o,t.getChildByName=i,t.removeChildByName=r}(DisplayUtil||(DisplayUtil={}));var EffectUtil;!function(t){function e(t,e){if(!t._play_effecting){t._play_effecting=!0,t.measure();var n=t.y;egret.Tween.get(t).to({y:n-e},200,egret.Ease.sineIn).to({y:n},500,egret.Ease.bounceOut).call(function(){t._play_effecting=!1},t)}}function n(t){t._play_effecting=!1,egret.Tween.removeTweens(t)}function o(e,n,o){if(void 0===o&&(o=!1),!e._play_effecting){e._play_effecting=!0,e.measure();var i=e.x,r=e.y,s=e.scaleX,a=e.scaleY;egret.Tween.get(e).to({scaleX:s*n,scaleY:a*n,x:i+e.width*(1-n)/2,y:r+e.height*(1-n)/2},100,egret.Ease.sineIn).call(function(){egret.Tween.get(e).to({scaleX:s,scaleY:a,x:i,y:r},100).call(function(){e._play_effecting=!1,o&&t.playScaleEffect(e,n,o)},this)},this)}}function i(t,e,n,o){void 0===e&&(e=16777215),void 0===n&&(n=16711680),void 0===o&&(o=3),o>0&&(egret.Tween.removeTweens(t),egret.Tween.get(t).wait(150).to({textColor:n},0).wait(150).to({textColor:e},0).call(function(){i(t,e,n,o-1)},this))}t.playJumpEffect=e,t.stopScaleEffect=n,t.playScaleEffect=o,t.playLabelColorEffect=i}(EffectUtil||(EffectUtil={}));var ExternalUtil;!function(t){function e(t){var e=window.sdk;return e.getURLVar(t)}function n(t){window.clipboardData&&(window.clipboardData.clearData(),window.clipboardData.setData("Text",t))}function o(t,e,n,o){var i=window.sdk;i.createQRCode(t,e,n,o)}function i(t,e){var n=window.sdk;n.loadSingleScript(t,e)}function r(t,e,n){var o=window.sdk;return o.setURLVar(t,e,n)}function s(t){var e=window.sdk;return e.cleanURLVar(t)}function a(t,e){var n=window.sdk;n.setItem(t,e)}function h(t){var e=window.sdk;return e.getItem(t)}function l(t){var e=window.sdk;e.removeItem(t)}function c(){var t=window.sdk;return t.isQQ()}function u(){var t=window.sdk;return t.isWX()}function p(){var t=window.sdk;return t.isAndroid()}function d(){var t=window.sdk;return t.isIOS()}function f(){var t=window.sdk;return t.isPcWx()}t.getURLVar=e,t.copyContent=n,t.createQRCode=o,t.loadSingleScript=i,t.setURLVar=r,t.cleanURLVar=s,t.setItem=a,t.getItem=h,t.removeItem=l,t.isQQ=c,t.isWX=u,t.isAndroid=p,t.isIOS=d,t.isPcWx=f}(ExternalUtil||(ExternalUtil={}));var GeomUtil;!function(t){function e(t){return t*f}function n(t){return t*m}function o(t,e){return Math.atan2(e.y-t.y,e.x-t.x)*f}function i(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function r(t){var e=t*m;return new egret.Point(Math.cos(e),Math.sin(e))}function s(t){return new egret.Point(Math.cos(t),Math.sin(t))}function a(t,e){var n=Math.atan2(e.y-t.y,e.x-t.x);return new egret.Point(Math.cos(n),Math.sin(n))}function h(t,e,n){var o=e*m;return t.add(new egret.Point(Math.cos(o)*n,Math.sin(o)*n))}function l(t,e,n){return t.add(new egret.Point(Math.cos(e)*n,Math.sin(e)*n))}function c(t,e){if(void 0===e&&(e=0),0>t||t>1)return 0;if(0>e||e>1)return 0;var n=.5-Math.sqrt((1-e)/4),o=t*(1-n)+n;return 4*(o-.5)*(o-.5)-1}function u(t,e,n,o){if(null==t||null==e||null==n||null==o)return!1;var i=(t.x-n.x)*(e.y-n.y)-(t.y-n.y)*(e.x-n.x),r=(t.x-o.x)*(e.y-o.y)-(t.y-o.y)*(e.x-o.x);if(i*r>0)return!1;var s=(n.x-t.x)*(o.y-t.y)-(n.y-t.y)*(o.x-t.x),a=(n.x-e.x)*(o.y-e.y)-(n.y-e.y)*(o.x-e.x);return s*a>0?!1:!0}function p(t,e,n,o){if(null==t||null==e||null==n||null==o)return null;var i=(t.x-n.x)*(e.y-n.y)-(t.y-n.y)*(e.x-n.x),r=(t.x-o.x)*(e.y-o.y)-(t.y-o.y)*(e.x-o.x);if(i*r>0)return null;var s=(n.x-t.x)*(o.y-t.y)-(n.y-t.y)*(o.x-t.x),a=(n.x-e.x)*(o.y-e.y)-(n.y-e.y)*(o.x-e.x);if(s*a>0)return null;var h=s/(r-i),l=h*(e.x-t.x),c=h*(e.y-t.y);return new egret.Point(t.x+l,t.y+c)}function d(t,e,n,o,i){if(!(t&&e&&n&&o&&i))return null;var r=t.x,s=t.y,a=(n.x-e.x)*(s-e.y)-(n.y-e.y)*(r-e.x),h=(o.x-n.x)*(s-n.y)-(o.y-n.y)*(r-n.x),l=(i.x-o.x)*(s-o.y)-(i.y-o.y)*(r-o.x),c=(e.x-i.x)*(s-i.y)-(e.y-i.y)*(r-i.x);return a>0&&h>0&&l>0&&c>0||0>a&&0>h&&0>l&&0>c?!0:!1}var f=180/Math.PI,m=Math.PI/180;t.radiansToDegrees=e,t.degreesToRadians=n,t.pointAngle=o,t.pointRadians=i,t.angleToSpeed=r,t.radiansToSpeed=s,t.angleSpeed=a,t.getCirclePoint=h,t.getCirclePoint2=l,t.getBezierY=c,t.getLineAcross=u,t.getLineAcrossPoint=p,t.isPointInQuad=d}(GeomUtil||(GeomUtil={}));var MathUtil=function(){function t(){}return t.linear=function(t,e,n){return(e-t)*n+t},t.clamp=function(t,e,n){return Math.max(e,Math.min(n,t))},t}();__reflect(MathUtil.prototype,"MathUtil");var RedPointUtil;!function(t){function e(){l||(l=!0,h=[],Game.registerSecond(n,null))}function n(){for(var t=h.length,e=t-1;e>=0;e--){var n=h[e];if(n){var r=n.dis,s=n.fun,a=n.scope,l=n.param,c=n.options;if(r.width&&r.height){var u=s.call(a,l);u&&r.stage&&r.visible&&r.alpha?o(r,u,c):i(r)}}}}function o(t,e,n){if(t){var o=t.__red__point;o||(o=RedPoint.pool.create(),t.__red__point=o),n.width||(n.width=t.width);var i=n.offX||0,r=n.offY||0;o.x=n.width+i,o.y=r,t instanceof egret.DisplayObjectContainer?o.parent?o.parent.setChildIndex(o,1e3):t.addChild(o):(o.x+=t.x-t.anchorOffsetX*t.scaleX,o.y+=t.y-t.anchorOffsetY*t.scaleY,o.parent?o.parent.setChildIndex(o,1e3):t.parent.addChild(o)),o.setData(e)}}function i(t){t&&t.__red__point&&(RedPoint.pool.release(t.__red__point),delete t.__red__point)}function r(t,n,o,i,r){if(e(),t){var s=h.indexOf(t);if(0>s){var a={};a.dis=t,a.fun=n,a.scope=o,a.param=r,a.options=i||{},t.__red__point_info=a,h.push(a)}else egret.warn("注册小红点时不能为空")}else egret.warn("注册小红点时不能为空")}function s(t){if(t){var e=t.__red__point_info;e&&(ArrayUtil.removeItem(h,e),e.fun=null,e.dis=null,e.scope=null,e.param=null,e.options=null,delete t.__red__point_info),t.__red__point}}function a(t,e){if(t){var n=t.__red__point_info;n&&(n.param=e)}}var h,l=!1;t.boot=e,t.add=r,t.remove=s,t.update=a}(RedPointUtil||(RedPointUtil={}));var StringUtil;!function(StringUtil){function trim(t){return t.replace(/(^\s*)|(\s*$)/g,"")}function getCharLength(t){for(var e=0,n=0;n<t.length;n++)t.charCodeAt(n)>127||94==t.charCodeAt(n)?e+=2:e++;return e}function getQueryString(str){var reg=new RegExp("(^|&)"+str+"=([^&]*)(&|$)","i"),result=window.location.search.substr(1).match(reg);return null!=result?eval(result[2]):null}function decodeName(t,e){void 0===e&&(e=!1);var n="玩家";if("object"==typeof t)n="玩家:"+t.uid;else{if(t)try{n=decodeURIComponent(t)}catch(o){n="玩家"}n=n.replace(new RegExp("/( )/g"),""),n.length>8&&!e&&(n=n.substr(0,6)+"...")}return n}function decodeStr(t,e){void 0===e&&(e="");var n=e;if(t)try{n=Base64.utf8to16(Base64.base64decode(t))}catch(o){n=e}return n}function convertImgURLTo64(t){return t.replace(/\/0$/,"/64")}function timeToString(t,e){void 0===e&&(e=!0),0>t&&(t=0);var n=Math.floor(t/3600),o=Math.floor(t%3600/60),i=Math.floor(t%60);return e=n>0,e?StringUtil.unshiftZero(n,2)+":"+StringUtil.unshiftZero(o,2)+":"+StringUtil.unshiftZero(i,2):StringUtil.unshiftZero(o,2)+":"+StringUtil.unshiftZero(i,2)}function timeToString2(t){0>t&&(t=0);var e=Math.floor(t/3600/24);t-=3600*e*24;var n=Math.floor(t/3600),o=Math.floor(t%3600/60),i=Math.floor(t%60);return e>0?StringUtil.unshiftZero(e,1)+"天"+StringUtil.unshiftZero(n,2)+"时"+StringUtil.unshiftZero(o,2)+"分"+StringUtil.unshiftZero(i,2)+"秒":n>0?StringUtil.unshiftZero(n,2)+"时"+StringUtil.unshiftZero(o,2)+"分"+StringUtil.unshiftZero(i,2)+"秒":StringUtil.unshiftZero(o,2)+"分"+StringUtil.unshiftZero(i,2)+"秒"}function dateToString(t,e){return e?t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+StringUtil.unshiftZero(t.getHours(),2)+":"+StringUtil.unshiftZero(t.getMinutes(),2)+":"+StringUtil.unshiftZero(t.getSeconds(),2):t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+StringUtil.unshiftZero(t.getHours(),2)+":"+StringUtil.unshiftZero(t.getMinutes(),2)}function unshiftZero(t,e){for(var n=t.toString();n.length<e;)n="0"+n;return n}function toFixed(t,e){return t?parseFloat(t.toFixed(e?e:0)):0
}function addWarp(t,e){if(null==t)return"";for(var n=0,o=0;o<t.length;o++){var i=t.charCodeAt(o);10==i?n=0:(127>i?n++:i>=128&&2047>i?n+=2:i>=2048&&55295>i||i>=57344&&65535>i?n+=2:i>=65536&&1114111>i&&(n+=2),n>=e&&(t=t.substr(0,o+1)+"\n"+t.substr(o+1),n=0,o++))}return t}function format(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=t;if(t&&t.indexOf("{0}")>-1)for(var i=e.length,r=0;i>r;r++)o=o.replace("{"+r+"}",e[r]);return o||""}StringUtil.trim=trim,StringUtil.getCharLength=getCharLength,StringUtil.getQueryString=getQueryString,StringUtil.decodeName=decodeName,StringUtil.decodeStr=decodeStr,StringUtil.convertImgURLTo64=convertImgURLTo64,StringUtil.timeToString=timeToString,StringUtil.timeToString2=timeToString2,StringUtil.dateToString=dateToString,StringUtil.unshiftZero=unshiftZero,StringUtil.toFixed=toFixed,StringUtil.addWarp=addWarp,StringUtil.format=format}(StringUtil||(StringUtil={}));var TextUtil;!function(t){function e(t,e,n,o){if(t){var i="<font color="+o+">"+n+"</font>";i=StringUtil.format(e,i),t.textFlow=r.parser(i)}}function n(t,e){}function o(t){var e=new egret.TextField;return e.size=t.size||16,e.x=t.x||0,e.y=t.y||0,e.width=t.width||20,e.height=t.height||20,e.textAlign=t.align||"center",e.verticalAlign=t.verticalAlign||"middle",e.textColor=void 0==t.textColor?16711680:t.textColor,e.strokeColor=t.strokeColor||0,e.stroke=t.stroke||0,e.bold=1==t.bold,e}function i(t){var e=new eui.BitmapLabel;return e.x=t.x||0,e.y=t.y||0,e.width=t.width||20,e.height=t.height||20,e.textAlign=t.align||"center",e.verticalAlign=t.verticalAlign||"middle",e.font="num_message_fnt",e}var r=new egret.HtmlTextParser;t.color=e,t.createNumTxt=n,t.createTxt=o,t.createBitmapText=i}(TextUtil||(TextUtil={}));var TimeUtil;!function(t){function e(t,e,n){void 0===e&&(e="/"),void 0===n&&(n=!0);var o=t.getHours(),i=t.getMinutes(),r=o>=10?o+"":"0"+o,s=i>=10?i+"":"0"+i;return n?t.getFullYear()+e+(t.getMonth()+1)+e+t.getDate()+" "+r+":"+s:t.getFullYear()+e+(t.getMonth()+1)+e+t.getDate()}function n(t,e){void 0===e&&(e=!1),t>=3600&&(e=!0);var n=Math.floor(t/3600),o=Math.floor((t-3600*n)/60),i=Math.floor(t-3600*n-60*o),r="";return e&&(r+=(n>9?n:"0"+n)+":"),r+=(o>9?o:"0"+o)+":",r+=i>9?i:"0"+i}function o(t,e){void 0===e&&(e="");var n="";return n=t>=86400?Math.ceil(t/86400)+"天"+e:t>3600?Math.ceil(t/3600)+"小时"+e:Math.ceil(t/60)+"分钟"+e}t.formatDate=e,t.timeToString=n,t.toChineseStr=o}(TimeUtil||(TimeUtil={}));var Util;!function(t){function e(t,n){if(!t||"object"!=typeof t)return n;for(var o in t){var i=t[o],r=typeof t[o];t[o]&&"object"===r?typeof n[o]===r?n[o]=e(t[o],n[o]):n[o]=e(t[o],new i.constructor):(null===n&&(n=new t.constructor),n[o]=t[o])}return n}function n(t,e,o){o||(o={});for(var i in t){var r=t[i],a=typeof r;if(s(r))o[i]||(o[i]=new r.constructor),n(r,e||null,o[i]);else if(e){var h=typeof e[i];a!=h?o[i]=r:r!=e[i]&&(o[i]=r)}else o[i]=r}return o}function o(t,e){if(e||(e=[]),t)for(var n=Object.keys(t),o=0,i=n.length;i>o;o++){var r=n[o];e.push(t[r])}return e}function i(t,e){var n=e-t,o=t;return n>0&&(o=t+Math.round(Math.random()*n)),o}function r(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e)||"number"==typeof e)return t[e];if(e.indexOf(".")>=0){for(var o=e.split("."),i=t,r=n,s=0,a=o.length;a>s;s++){if(!i||!i.hasOwnProperty(o[s])){r=n;break}r=i[o[s]],i=i[o[s]]}return r}return n}return n}function s(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}t.mixin=e,t.objDiff=n,t.objToArr=o,t.getRandomInt=i,t.getPropValue=r,t.isObject=s,t.isArray=a}(Util||(Util={}));